IPC standards and conventions

Scope
* Applies to all C and C plus plus code in ipc directory
* Extends repository root rules

Resource management
* Always check return values of system calls like pipe, fork, dup, shm_open, mmap, sem_open, msgget, msgsnd, msgrcv, socketpair
* Use perror after system call failure and include clear context
* Provide deterministic cleanup paths for all resources including file descriptors, mappings, semaphores, shared memory, and message queues
* Prefer single exit with cleanup labels or small RAII wrappers to avoid leaks

Error handling
* Validate all inputs before calling system interfaces
* Fail fast with clear messages without leaking internals
* Check errno on failure paths and map to clear messages
* Return appropriate non zero exit codes from main and propagate errors from helpers

Synchronization
* Use appropriate primitives including semaphores, mutexes, and condition variables when sharing memory
* Document ordering and ownership for shared data
* Use timed waits where blocking could stall the system and handle timeout paths explicitly
* Avoid deadlocks by following a single lock order and minimizing critical sections

Memory safety
* Check mmap against MAP_FAILED and verify lengths and protections
* Ensure alignment and padding for shared structs and avoid undefined behavior across processes
* Bound all buffer operations and avoid unbounded string functions
* Initialize shared memory before exposing to other processes

Security
* Use least privilege permissions when creating shared objects and queues
* Do not use predictable names for shared objects without a namespacing strategy
* Sanitize all external inputs and data passed through IPC channels
* Avoid storing sensitive data in shared memory without protection

Signals and processes
* Handle SIGCHLD or use waitpid with correct options to avoid zombies
* Use exec family with explicit argv arrays and validated paths
* Reset or block signals where necessary during critical sections

Style and documentation
* Keep examples minimal and focused on one IPC mechanism
* Add concise comments only where intent or ordering is non obvious
* Use meaningful names for keys, queue identifiers, and shared objects
* Prefer early returns and shallow nesting

Testing and validation
* Test success and failure paths including cleanup correctness
* Validate cross process communication and ordering invariants
* Include simple harness code to exercise both producer and consumer sides

References
* See system programming samples in system programming slash processes for concrete patterns


